p8105\_mtp\_gw2383
================
Guojing Wu
2018/10/17

-   [read and tidy data](#read-and-tidy-data)
-   [activity over time](#activity-over-time)
-   [24-hour profile](#hour-profile)

read and tidy data
------------------

``` r
# change rhe cache parameter!!!!
# is format_time necessary?

activity_df = 
  read_csv("./data/p8105_mtp_data.csv") %>% 
  janitor::clean_names() %>% 
  gather(key = act_time, value = count, activity_1:activity_1440) %>% # make it recordable
  mutate( # refactor the variables
    day = factor(day, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")), 
    week = factor(week), 
    act_time = factor((act_time), levels = paste("activity", (1:1440), sep = "_"))
    ) %>% 
  arrange(week, day) # reordering the rows by 'day' to make it more readable
```

the data is collected across 329 days (47 weeks), and each day we collected the activity data 1440 times.

<!--
A spaghetti plot: total_count over each week:


```r
activity_df %>%
  group_by(week, day) %>%
  summarise(total_act = sum(count)) %>%
  ggplot(aes(x = day, y = total_act, group = week, color = as.character(week))) +
  scale_y_log10() +
  geom_line()
```

![](p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-2-1.png)
-->
A boxplot: distribution over each week:

``` r
activity_df %>% 
  group_by(week, day) %>% 
  summarise(total_act = sum(count)) %>% 
  ggplot(aes(x = week, y = total_act, group = week)) +
  geom_boxplot() +
  labs(
    y = "Sum of activity counts", 
    caption = "Fig.1 boxplot for sum of each day's counts between weeks"
  ) +
  theme(
    axis.text.x = element_text(size = 5), 
    plot.caption = element_text(hjust = -0.2, size = 10)
  )
```

<img src="p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-3-1.png" width="90%" />

Here we can see that for each week there are some ourliers. And the whole `week 3` was collapsed into one dot, the proportion of value `1` within `week 3` is as high as 99.890873%.

activity over time
------------------

``` r
# aggregate the count data across minutes
cross_min = activity_df %>% 
  group_by(week, day) %>% 
  summarise(sum_byday = sum(count))

ggplot(data = cross_min, aes(x = c(1:length(sum_byday)), y = sum_byday)) +
  geom_point() +
  stat_smooth(method = "lm", col = "red") +
  labs(
    x = "day", 
    y = "sum of each day's counts", 
    caption = "Fig.2 scatterplot for sum of each day's counts between days"
  ) +
  theme(
    plot.caption = element_text(hjust = -0.2, size = 10)
    )
```

<img src="p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-4-1.png" width="90%" />

Here we can see the linear regression line, the slope is positive: 573.0106366 and the p-value is very significant (2.097083710^{-11}). Which suggest that this participant became more active over time.

Is day of the week affects the activity?(in isolation and in additon to the effect of time)

``` r
# line
in_isolation = 
  activity_df %>% 
  group_by(day) %>% 
  summarise(sum_byweek = sum(count)) %>% 
  ggplot(aes(x = day, y = sum_byweek, group = 1)) +
  geom_point() +
  geom_line() +
  labs(
    y = "sum of activity counts", 
    title = "A)"
  ) + 
  theme(title = element_text(size = 8))

in_addition = 
cross_min %>% 
  ggplot(aes(x = week, y = sum_byday, group = day, col = day)) +
  geom_smooth(se = FALSE) +
  labs(
    y = "sum of activity counts", 
    title = "B)", 
    caption = "Fig.3 A) Relationship between day of the week and activity in isolation to the effect of time.\n B) Relationship between day of the week and activity in addition to the effect of time"
  ) +
  theme(
    axis.text.x = element_text(size = 5),
    title = element_text(size = 8), 
    plot.caption = element_text(hjust = -0.2, size = 10)
  )

in_isolation / in_addition
```

<img src="p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-5-1.png" width="90%" />

<!-- ```{r, dpi = 300, out.width = "90%"} -->
<!-- # boxplot -->
<!-- activity_df %>%  -->
<!--   ggplot(aes(x = day, y = count, group = day)) + -->
<!--   geom_boxplot() + -->
<!--   scale_y_log10() + -->
<!--   labs( -->
<!--     y = "sum of activity counts",  -->
<!--     title = "sum of each weekday's counts" -->
<!--   ) -->
<!-- ``` -->
24-hour profile
---------------

``` r
# distribution of the activity count by using heatmap
activity_df %>% 
  mutate(
    count = log10(count), # doing log10 transformation of the count
    format_time = factor(interaction(week, day), levels = paste(rep(1:47, each = 7), c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"), sep = ".")) # relevel eachday, so it ranked properly
    ) %>% 
  ggplot(aes(x = act_time, y = format_time, fill = count)) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "steelblue") +
  guides(fill = guide_legend(title = "log10(count)")) +
  scale_x_discrete( # rename the x axis label
    breaks = paste("activity", (0:23)*60 + 1, sep = "_"), 
    labels = c(0:23), 
    name = "time/hour"
    ) +
  scale_y_discrete( # rename the y axis label
    breaks = paste(1:47, "Sunday", sep = "."), 
    labels = c((0:46) * 7 + 1), 
    name = "day"
  ) +
  geom_vline(xintercept = 7*60, col = "red") + # an vertical line at 7 o'clock
  geom_vline(xintercept = 23*60, col = "red") + # an vertical line at 23 o'clock
  labs(
    caption = "Fig.4 heatmap for 24-hour activity \"profiles\" for each day"
  ) +
  theme(
    axis.text.y = element_text(size = 7),
    plot.caption = element_text(hjust = 0, size = 10)
  )
```

![](p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-6-1.png)

Here we can see that in general, the participant's avtive time is around `7:00 - 23:00`, and his inactive time is around `23:00 - 7:00`.

24-hour activity profile (time effect)

``` r
# activity_df %>% 
#   group_by(week, act_time) %>% 
#   summarise(sum_byweekday = sum(count)) %>% 
#   ggplot(aes(x = act_time, y = sum_byweekday, group = week, color = week)) +
#   geom_smooth(se = FALSE) +
#   scale_x_discrete( # rename the x axis label
#     breaks = paste("activity", (0:23)*60 + 1, sep = "_"), 
#     labels = c(0:23), 
#     name = "time/hour"
#     ) +
#   labs(
#     y = "sum of activity counts",
#     caption = "Fig.5 A) relationship between time and 24-hour activity profile"
#   ) +
#   theme(
#     axis.text.y = element_text(size = 7),
#     plot.caption = element_text(hjust = 0, size = 10)
#   )
# 
# # heatmap
# activity_df %>% 
#   group_by(week, act_time) %>% 
#   summarise(sum_byweek = mean(count)) %>% 
#   mutate(sum_byweek = log10(sum_byweek)) %>% 
#   ggplot(aes(x = act_time, y = week, fill = sum_byweek)) +
#   geom_tile() +
#   scale_fill_gradient(low = "white", high = "steelblue") +
#   guides(fill = guide_legend(title = "log10(count)")) +
#   scale_x_discrete( # rename the x axis label
#     breaks = paste("activity", (0:23)*60 + 1, sep = "_"), 
#     labels = c(0:23), 
#     name = "time/hour"
#     ) +
#   labs(
#     caption = "Fig.4 heatmap for 24-hour activity \"profiles\" for each day"
#   ) +
#   theme(
#     axis.text.y = element_text(size = 7),
#     plot.caption = element_text(hjust = 0, size = 10)
#   )

# 3D plot 
count_time = activity_df %>% 
  group_by(week, act_time) %>% 
  summarise(sum_byweek = mean(count)) %>% 
  mutate(hour = 0)

for (i in c(0:23)) { # aggregate each hour's count
  count_time$hour = count_time$hour + ifelse(count_time$act_time %in% paste("activity", (i*60+1):(i*60+60), sep = "_"), i, 0)
}

count_time = count_time %>% 
  group_by(week, hour) %>% 
  summarise(sum_byhour = sum(sum_byweek)) %>% 
  spread(key = hour, value = sum_byhour) %>% 
  group_by() %>% 
  select(2:25) %>% 
  as.matrix()
plot_ly(z = ~count_time) %>% # use plot_ly
  add_surface()
```

<!--html_preserve-->

<script type="application/json" data-for="htmlwidget-9347caebb6c5d7c4181d">{"x":{"visdat":{"3ce424c55fd5":["function () ","plotlyVisDat"]},"cur_data":"3ce424c55fd5","attrs":{"3ce424c55fd5":{"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"zaxis":{"title":"count_time"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"colorbar":{"title":"count_time","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0170893419249095","rgba(69,8,89,1)"],["0.0296106510601956","rgba(70,14,93,1)"],["0.0447516894205363","rgba(70,20,98,1)"],["0.062285029657417","rgba(71,26,104,1)"],["0.0811666494077981","rgba(72,31,110,1)"],["0.109334653915147","rgba(72,40,119,1)"],["0.139261810355098","rgba(70,49,124,1)"],["0.17163889102305","rgba(68,59,129,1)"],["0.226326998820249","rgba(62,75,137,1)"],["0.278747986001388","rgba(57,89,140,1)"],["0.322974532590868","rgba(51,101,142,1)"],["0.363087622718907","rgba(47,111,142,1)"],["0.399017231155388","rgba(44,119,142,1)"],["0.424089134659053","rgba(41,125,142,1)"],["0.448617147075624","rgba(38,131,142,1)"],["0.473596714802208","rgba(38,137,141,1)"],["0.494571946655621","rgba(37,143,140,1)"],["0.513583843026693","rgba(36,147,139,1)"],["0.536795226961867","rgba(33,153,138,1)"],["0.561658143012552","rgba(33,159,136,1)"],["0.592916041728604","rgba(41,166,132,1)"],["0.628719289266184","rgba(48,174,127,1)"],["0.701596668036241","rgba(75,190,112,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[974.428571428571,754.428571428572,518.571428571429,1183.42857142857,5981.85714285714,8058.57142857143,3324,7197.85714285714,22265.4285714286,12876.8571428571,11277.5714285714,15376.1428571429,17658.2857142857,16581.4285714286,18881.1428571429,22832.5714285714,17167.1428571429,19356.7142857143,21396.1428571428,21858.4285714286,23608.7142857143,17520,8952,1589],[2872.85714285714,1895.28571428572,2399.28571428571,1731.42857142857,671.714285714286,1763.85714285714,6034.14285714286,9771,21522.5714285714,25414.7142857143,14714.2857142857,12855.5714285714,18505.4285714286,14874.1428571429,16755.4285714286,14868.8571428571,15277.5714285714,14145,14874.2857142857,11382.2857142857,2439.28571428571,1813.28571428571,6348.57142857142,2823.85714285714],[60,60,60,60,60,60,60,60,60,181.142857142857,60,60,95.7142857142856,60,60,63,60,60,60,63,60,60,60,60],[216.571428571429,970.857142857143,222.285714285714,215.714285714286,884.428571428572,831.428571428571,883.285714285714,134.571428571428,1765.14285714286,4935.42857142857,4501.14285714286,9220.14285714284,2386.57142857143,3848.28571428572,7322.42857142857,5998.28571428571,7741,4952.42857142857,4243.71428571429,2042.57142857143,3205.14285714286,6672.57142857143,3466.42857142857,413.714285714286],[2707.85714285714,519.142857142857,1194,1041.85714285714,6342.71428571428,5551.71428571429,12967.5714285714,11422.5714285714,14000.1371942011,18227,15338,17360.1428571429,14974.1428571429,23280.8571428571,16269.8571428571,14799.4285714286,8272.42857142858,20438.4285714286,15201.1428571429,10547.4285714286,15430.2857142857,12288.5714285714,13747.8571428571,8289.42857142857],[2134.57142857143,2774.14285714286,721.714285714286,1417.57142857143,5084.14285714286,7571.71428571429,8961.57142857143,15938.4285714286,24479.2857142857,18767,17237.2857142857,21900.8571428571,23097.5714285714,19493.2857142857,16102,28430.2857142857,20643.4285714286,18493.8571428571,16725.8571428571,13739.4285714286,18815.1428571428,16491.4285714286,7875.71428571429,3895.57142857143],[6102.28571428571,903.857142857143,1648,3529.71428571429,1897.57142857143,2757.71428571429,5393,6292,15872.5714285714,16784.2857142857,22276.5714285714,22080.5714285714,21153,18335.1428571429,18254.5714285714,23135.1428571429,21079.1428571429,19175.8571428571,18386.8571428571,24840.1428571428,15219.7142857143,16115.2857142857,15094.4285714286,8928.99999999999],[1805.28571428572,796.000000000001,1567.85714285714,2467.85714285714,1980.71428571428,5144.14285714285,3766.14285714286,7519.28571428571,12510.2857142857,10891.4285714286,24193.8571428571,18621,20955.5714285714,19245.7142857143,21579.8571428571,25999.4285714286,18191.7142857143,16322.5714285714,22934.5714285714,19632,17619.8571428571,14743.5714285714,6130.28571428572,6835.85714285715],[3400.71428571429,3282.85714285714,2208.42857142857,1481.42857142857,2338.85714285714,3219,5764.28571428571,20000.8571428571,18315.8287526427,22430.4285714286,28326.4285714286,26381.5714285714,23930.7142857143,28273.4285714286,31823.5714285714,26917.7142857143,20952.1428571428,20003.1428571429,18182.4285714286,20194.1428571429,20888.5714285714,14032.1428571429,8174.14285714286,8084.85714285714],[3159.14285714286,2717.14285714286,8452.14285714286,5543.71428571429,2417.28571428572,2706.85714285714,4240,12442.2857142857,23011.5714285714,22966.5714285714,22767.7142857143,25536.4285714286,23551.8571428571,26113.5714285714,23229.5714285714,16136.1428571429,11865,14885.7142857143,21497.1428571429,29414,26851.7142857143,16710.4285714286,5819.42857142857,3103.42857142857],[1389.28571428571,833.714285714285,1518.85714285714,6053.57142857143,5403.14285714286,10609.5714285714,11884.2857142857,11230.2857142857,14065.7142857143,29791.7142857143,16229.2857142857,21479.5714285714,24562.4285714286,14460.2857142857,21910.7142857143,31464.5714285714,23479.1428571429,25293.8571428571,25635.5714285714,22664.8571428571,17065.4285714286,12875.8571428571,7714.28571428571,1830],[397.857142857143,684.285714285715,581,2213.42857142857,848.857142857144,2073.71428571428,3604,2826.71428571429,7932.14285714286,4592,5887.28571428571,9492.85714285714,6175.85714285714,6989.14285714285,6918.42857142857,5199.85714285714,5869.28571428571,6898.57142857142,6594.28571428571,5132.71428571429,6166.71428571428,4590.85714285714,2681,804.857142857143],[713.285714285715,1292,655.142857142858,2397.14285714286,1156.42857142857,2898.28571428571,8823.85714285714,14793.8571428571,9570.57142857143,15092,16108.1428571429,22476.1428571429,26541.4285714286,15100.7142857143,19204.7142857143,19063,13500.8571428571,11310.8571428571,14956.2857142857,23093.4285714286,20848.5714285714,12945.5714285714,10021.1428571428,3178],[4526.14285714286,1567,1089.14285714286,4391.71428571428,8638.42857142857,11477.4285714286,11719.4285714286,21145.2857142857,21334.5714285714,14380.1428571429,23326.5714285714,19656,23405.2857142857,18361.8571428571,23288.4285714286,21197.1428571429,20603.5714285714,20592.8571428571,38891.8571428571,34132.8571428571,25351.8571428571,13699.8571428572,6154.42857142857,4555.71428571429],[2984.28571428571,3950.57142857143,5218.28571428571,7913.28571428571,6892.14285714286,13174.4285714286,12172.7142857143,16208.8571428571,12183.7142857143,15699.1428571429,15524.1428571429,13639,17809.8571428571,14345.7142857143,21180.8571428571,24804.5714285714,19704.5714285714,19373.8571428571,27906.8571428571,26940.5714285714,23346.8571428571,13702.4285714286,3489.85714285714,678.714285714286],[2166.01587301587,1255.00634920635,2420.95873015873,4958.33968253968,4346.65714285714,4251.70476190476,5921.45714285714,12364.1968253968,18203.5756407787,26166.4463768116,21679,27028.5015873016,23741.7841269841,17121.8888888889,19566.7251803752,19829.7301587302,20115.1873015873,21098.726984127,17734.1523809524,20437.4761904762,28123.5174603175,26301.0349206349,12448.2793650794,9842.86349206349],[3736.85714285714,2393.71428571429,3968.71428571429,830.857142857143,2886.71428571429,7139.42857142857,12994.4285714286,26765.4285714286,20313.5714285714,27700.7142857143,30837.1428571428,33241.8571428571,26410,18812.2857142857,23009.5714285714,18009.1428571429,34914.8571428571,22943.7142857143,23471.8571428571,33519.5714285714,41326.4285714286,26190.1428571429,12133.4285714286,8123.57142857142],[3076.57142857143,1979.42857142857,1915.71428571429,1375.14285714286,4442.57142857143,6659.14285714286,12598.4285714286,19372.2857142857,17675.7142857143,21031.7142857143,30056.1428571429,21398.8571428571,24848,20133.7142857143,25412.1428571428,25598.8571428571,29310.1428571428,27782.1428571428,30319.4285714286,32135.7142857143,42826.1428571428,34304.5714285714,20805.2857142857,5644.42857142857],[3244,581.714285714286,426.142857142857,1619.57142857143,1568.42857142857,6203,6885.42857142857,7073.57142857143,12055.4285714286,18886.5714285714,20896.2857142857,18714.5714285714,21483.2857142857,16311.1428571429,17566.1428571429,15999.1428571428,16081,20837.7142857143,21305.4285714286,10096.8571428571,10486.7142857143,13156.5714285714,6142.57142857143,6646.57142857143],[814.428571428572,1118.85714285714,913.714285714286,1038.85714285714,3697.71428571429,11384,30476.8571428571,34393.2857142857,9331.42857142857,14647.8571428571,13591.8571428571,22999.4285714286,18496.4285714286,20600.8571428571,21453,21736,17727.4285714286,13932.2857142857,21457.1428571429,20368.2857142857,26560.8571428571,19814.4285714286,9610.57142857143,2784.28571428571],[1007.14285714286,2174.85714285714,1146.85714285714,2236.14285714286,6102.42857142857,5676.57142857143,3570.14285714286,11942.1428571429,22832.4285714286,21047.5714285714,17017.1428571429,23008.8571428571,24079.5714285714,21853.8571428571,17127.4285714286,24491.1428571429,18953.2857142857,15694.4285714286,21811,12599.2857142857,19297.7142857143,12697.8571428571,4936.28571428571,929.714285714286],[1022.85714285714,1351.57142857143,2780.28571428572,5193.71428571429,4607.57142857143,4930.42857142857,9739.85714285713,19179,28058.8861421524,26803.2857142857,18723.8571428571,21346,24744,21244.4285714286,24848.2857142857,20832,17823.1428571429,24641.5714285714,15497,15099.2857142857,19007.4285714286,13801.5714285714,9597.85714285715,4739],[966.857142857143,5041.42857142857,4310.42857142857,4666,2785.57142857143,3429.85714285714,7032.85714285714,9641.57142857143,26922.4285714286,25799,17730.1428571429,24562.1428571428,18946,19245.5714285714,22472.1428571428,15701.5714285714,16125.1428571429,25229.5714285714,22788.4285714286,30454.8571428571,28355.7142857143,25382.8571428571,14829.2857142857,6172.28571428571],[999.857142857143,2003.57142857143,1637,4437,2563.85714285714,3988.42857142857,9775.14285714286,19306.1428571429,27533.2857142857,24918,30842.8571428571,19882.8571428571,20314.5714285714,19704,16643.1428571429,18048,17489.8571428571,15025,16585.8571428571,16366.7142857143,18095.7142857143,13246.7142857143,6533.57142857143,4710.28571428571],[3489.14285714286,1790.57142857143,1546.57142857143,2766.28571428572,4839.57142857143,8976.14285714286,10548.4285714286,10928.5714285714,20816.8571428571,30922,23674.7142857143,28818,23556.4285714286,24551.1428571428,26824.8571428571,24937.8571428571,22089.7142857143,21879.8571428571,22682.5714285714,19112.5714285714,17504.8571428571,14107,8197.71428571429,2815.28571428571],[1556,1031.14285714286,2315.71428571428,3310,6022.85714285714,3531.57142857143,8694.14285714286,17300.4285714286,27253.1428571429,26061.7142857143,20760.2857142857,24482.2857142857,14250.5714285714,18027.5714285714,21634.7142857143,21784,19812.4285714286,20249.7142857143,14798.7142857143,17760.4285714286,27332.8571428571,17533.4285714286,8946.14285714286,8229.71428571428],[3092.85714285714,1663.85714285714,904.142857142858,3760,3242.28571428571,4207.14285714286,11575,10539.5714285714,10728.7142857143,16812.2857142857,23101.5714285714,23912.1428571429,27840.5714285714,26016.4285714286,21369.2857142857,19191.8571428571,22758,32509.4285714286,25329.2857142857,21790.2857142857,18481.1428571429,23752.1428571428,21143.4285714286,9905.57142857143],[1785.57142857143,1620.14285714286,1440,3256.14285714286,2585.57142857143,6363.85714285715,12781,29674,21608.1428571429,17953.2857142857,22283.1428571429,21016.2857142857,25466.7142857143,22526,21020.6331168831,34089,26548.4285714286,28849,25430.8571428571,17714.1428571429,20534.5714285714,18592.4285714286,10665.7142857143,2020.85714285714],[1295.42857142857,1700.28571428571,1822.71428571429,8043.71428571428,2877.28571428572,3672,5074.14285714286,19074.8571428571,27149.5714285714,20617.5714285714,22005.1428571429,29256.4285714286,30258.7142857143,22746.2857142857,24833.4285714286,16228.1428571429,18703.7142857143,23994.8571428571,18520.7142857143,15403.8571428571,19107.7142857143,11853.4285714286,5135.85714285714,6911.71428571429],[1245,331.428571428571,2076.85714285714,995.571428571428,7968.57142857144,10040.7142857143,21803.2857142857,18720.5714285714,17435.5714285714,17067,19895.4285714286,19509.8571428571,14127.4285714286,18969.5714285714,17572.1428571429,17183.1428571429,19421.4285714286,18112.1428571429,20072,23613.1428571428,14595.5714285714,17173.1428571429,15533.1428571429,6041.42857142857],[263.714285714286,1329.14285714286,445.857142857143,742.857142857143,3657.42857142857,1236.14285714286,792.428571428572,12696.8571428571,17337,8972.71428571428,12573,11978.1428571429,18116.7142857143,11776.2857142857,11885.8571428571,17500.8571428571,12211.5714285714,11924.7142857143,16218.1428571429,19500.8571428571,15880.7142857143,15296.5714285714,12093.4285714286,5668.42857142857],[6981.14285714286,4355.14285714286,636,1080.14285714286,2169.42857142857,2294,11983,13265.5714285714,21477.7142857143,15755.2857142857,20871.7142857143,35119.4285714286,16217.2857142857,22165.2857142857,22360.5714285714,19987.8571428571,34045.5714285714,21375.2857142857,23731.5714285714,21631.2857142857,24709.8571428571,22710.1428571428,11168.7142857143,10876.5714285714],[1523.71428571429,951.142857142857,1463.71428571429,3832.42857142857,9782.28571428571,7771.42857142857,9155,6653,17345.7142857143,19224.4285714286,15284,18950.5714285714,27795.1428571429,21425.8571428571,25570.2857142857,19961.4285714286,23848.4285714286,21799,26488.4285714286,21522.4285714286,21983.5714285714,17113,12380.5714285714,2710.85714285715],[3711.14285714286,2949.16770186335,1160.95652173913,2006.33850931677,4018.14906832298,8889.06211180125,11747.0062111801,13444.8043478261,21539.8788819876,23701.2888198758,24556.9161490683,27431.8571428571,21519.5590062112,20210.7080745342,18690.5869565217,17391.2111801242,23036.0031055901,22973.7608695652,19625.3043478261,18793.0217391304,13697.3850931677,12334.1925465839,9737.92546583851,6326.30124223602],[2022.01897860594,1412.49703243616,1673.92767425811,2458.38937198068,5023.17888198758,10346.4718426501,16817.0658385093,21193.5819185645,17533.925523471,21782.6047619048,22892.0931677019,20281.4363699103,21870.7872325742,19018.5907522429,19513.6910188845,19704.0500345066,20864.8084195997,20181.7611456177,21547.1399585921,22318.9047619048,20224.2317460317,17997.6063492063,12694.1365079365,5246.43492063492],[833.285714285715,2185.57142857143,5260,3528.14285714286,11717,7065.42857142857,5031.85714285715,9821.57142857142,17292.1428571429,26131,32151.1428571429,42212.5714285714,39188.7142857143,30485.2857142857,22718,26408.2857142857,24191,22256.5714285714,26530.8571428571,36835.8571428571,30426.5714285714,17132,9401.85714285714,5353],[12662.5714285714,4859.85714285714,3832.14285714286,1934.85714285714,7516.42857142857,14593.2857142857,14799.1428571429,19595,29929.2857142857,20468.1428571429,25280.1428571429,29557.4285714286,24775.5714285714,25008.2857142857,26455.1428571429,24734.5714285714,26278.7142857143,19031.1428571429,17134.1428571429,16512,28510.4285714286,25183.1428571428,21176.4285714286,15848.7142857143],[1152.42857142857,949.000000000001,1734.42857142857,3107.42857142857,6392.71428571428,9863,16743.7142857143,15642.5714285714,16550.2857142857,20770,29256.7142857143,22189.5714285714,20911.2857142857,22883.8571428571,24469.5714285714,25258,30912,32737.7142857143,31196.5714285714,23043.1428571429,20156.2857142857,11998.2857142857,12619.1428571429,2886.85714285714],[2231.57142857143,1245.71428571429,3556.42857142857,5868.85714285714,1895.28571428572,2959.42857142857,6460.71428571428,25319.8571428571,21691.2857142857,22318,16481,23967.5714285714,20697.8571428571,22219,17999.2857142857,23750.8571428571,22668.2857142857,23758.2857142857,22261.2857142857,25397.1428571429,23599,28753,11134.8571428571,2091.85714285714],[2180.28571428572,1824.57142857143,812.714285714286,4416.14285714286,5097.85714285714,7001.42857142857,5773,13344.8571428571,20837,22119.2857142857,30890.5714285714,32101.7142857143,28458,20500.2857142857,21003,33201.5714285714,34474.1428571429,39333.5714285714,24819.4285714286,23684.7142857143,22100.5714285714,17286.4285714286,17007,4775.14285714286],[1663.57142857143,1537.14285714286,1733.14285714286,2441.42857142857,6039.28571428572,8052.71428571429,11163.1428571429,7184,21385.7142857143,28928.9378881988,27698.8571428571,27660.5714285714,23163.7142857143,21534.4285714286,24665.8571428571,26567,21818.4285714286,25517,24524.5714285714,26548.7142857143,25263.5714285714,22641.7142857143,13536.5714285714,6464.85714285714],[7439.28571428571,1342.57142857143,1064,1569.71428571429,6375,6429,2502.85714285714,3236.57142857143,9335,24337.5714285714,25627.2857142857,27503.7142857143,18083.4285714286,18911.5714285714,23959,24052.1428571429,33761.1428571428,25871.7142857143,20220.2857142857,17527.7142857143,28587.7142857143,18637.4285714286,21304.4285714286,15032.8571428571],[5890.42857142857,3282.71428571429,1995.57142857143,3188.42857142857,5233.14285714286,7084.57142857143,9667.71428571428,18992,19911.2857142857,23061.7142857143,24238.8571428571,21154.7142857143,21969.1428571429,22995.4285714286,28755.7142857143,31883.4285714286,36397.1428571428,25669.2857142857,22591,25680.8571428571,36685.5714285714,20150.2857142857,20807,5192.57142857143],[9626.14285714286,5267.42857142857,3208.28571428572,2100.71428571429,3617,2413.85714285714,2912,10839.7142857143,14902.8571428571,16075.4285714286,24568.5714285714,33441.4285714286,24807,22146.5714285714,26768.7142857143,24081.8571428571,27276.2857142857,26517.8571428571,21669.2857142857,27054.5714285714,24008.2857142857,23089.5714285714,23867.2857142857,19659.4285714286],[794,1106.14285714286,1592.57142857143,3520.85714285714,3910.85714285714,4984.71428571429,8818.42857142857,18015.1428571429,26391.1428571428,20677.5714285714,19974.1428571428,19855,24768.7142857143,19054.8571428571,22490.1428571429,26236.4285714286,23934.1428571429,29244.7142857143,28856.7142857143,23130.1428571428,23449.2857142857,25117,8750.57142857143,3684],[3878.14285714286,1927.71428571428,2792.85714285714,4262,4481.28571428571,4726.28571428571,3916,20048.5714285714,18549.7142857143,20855,22258,20400.1428571429,27820.1428571428,29144.1428571429,32894.2857142857,25504.2857142857,25746.4285714286,29796.4285714286,23092.1428571428,42027,38074,23230,12007.8571428571,5221.57142857143],[2135.71428571429,2364.57142857143,2094.14285714286,1050.28571428571,2725,3901.42857142857,5763.85714285714,10924.7142857143,19418.5714285714,24311.2857142857,23849.5714285714,23672.5714285714,31253.5714285714,27941.8571428571,26372.5714285714,22988,32252,28916.7142857143,25907.8571428571,27730.4285714286,16181.7142857143,14889.7142857143,10894.4285714286,3397]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<!--/html_preserve-->
24-hour activity profile (day of the week effect)

``` r
activity_df %>% 
  group_by(day, act_time) %>% 
  summarise(sum_byweekday = sum(count)) %>% 
  ggplot(aes(x = act_time, y = sum_byweekday, group = day, color = day)) +
  geom_smooth(se = FALSE) +
  scale_x_discrete( # rename the x axis label
    breaks = paste("activity", (0:23)*60 + 1, sep = "_"), 
    labels = c(0:23), 
    name = "time/hour"
    ) +
  labs(
    y = "sum of activity counts",
    caption = "Fig.5 B) relationship between day of the week and 24-hour activity profile"
  ) +
  theme(
    axis.text.y = element_text(size = 7),
    plot.caption = element_text(hjust = 0, size = 10)
  )
```

    ## `geom_smooth()` using method = 'gam' and formula 'y ~ s(x, bs = "cs")'

![](p8105_mtp_gw2383_files/figure-markdown_github/unnamed-chunk-8-1.png)

Here we can see `Friday night` and `Sunday afternoon` are different from the other five days, the total activity counts are higher and have greater fluctuation.
